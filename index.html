<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Leave Time</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
    --bg:#0a0d14;
    --card:#111827;
    --border:#1f2937;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --accent:#6366f1;
}

* { box-sizing:border-box; }

body {
    margin:0;
    min-height:100vh;
    background:var(--bg);
    font-family:system-ui,-apple-system,sans-serif;
    color:var(--text);
    display:flex;
    justify-content:center;
    align-items:center;
    padding:16px;
}

.card {
    position:relative;
    width:100%;
    max-width:420px;
    background:var(--card);
    border:1px solid var(--border);
    border-radius:16px;
    padding:20px;
}

.reset {
    position:absolute;
    top:12px;
    right:12px;
    background:none;
    border:none;
    color:var(--muted);
    font-size:14px;
    cursor:pointer;
}

h1 {
    margin:0;
    font-size:20px;
}

p {
    margin:6px 0 20px;
    font-size:14px;
    color:var(--muted);
}

.time-row {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 8px;
}

input {
    min-width: 0;
    padding:14px;
    font-size:16px;
    background:#020617;
    border:1px solid var(--border);
    border-radius:12px;
    color:var(--text);
    text-align:center;
}

.toggle {
    display:flex;
    gap:8px;
    margin-top:12px;
}

.toggle button {
    flex:1;
    padding:12px;
    font-size:14px;
    border-radius:12px;
    border:1px solid var(--border);
    background:#020617;
    color:var(--text);
}

.toggle button.active {
    background:var(--accent);
    border-color:var(--accent);
}

button.calculate {
    margin-top:18px;
    width:100%;
    padding:14px;
    font-size:16px;
    font-weight:600;
    border-radius:12px;
    border:none;
    background:var(--accent);
    color:white;
}

.result {
    margin-top:18px;
    padding:14px;
    border-radius:12px;
    background:#020617;
    border:1px solid var(--border);
    text-align:center;
    font-size:18px;
    display:none;
}
</style>
</head>

<body>
<div class="card">
    <button class="reset" onclick="resetAll()">Reset</button>

    <h1>Leave Time</h1>
    <p>Enter login time. We add 8h 45m.</p>

    <div id="desktopInput">
        <div class="time-row">
            <input id="hh" placeholder="HH" inputmode="numeric" maxlength="2">
            <input id="mm" placeholder="MM" inputmode="numeric" maxlength="2">
            <input id="ss" placeholder="SS" inputmode="numeric" maxlength="2">
        </div>

        <div class="toggle">
            <button id="amBtn" class="active">AM</button>
            <button id="pmBtn">PM</button>
        </div>
    </div>

    <div id="mobileInput" style="display:none">
        <input type="time" id="mobileTime" step="1">
    </div>

    <button class="calculate" onclick="calculate()">Calculate</button>
    <div class="result" id="result"></div>
</div>

<script>
const isTouch =
    "ontouchstart" in window || navigator.maxTouchPoints > 0;

if (isTouch) {
    desktopInput.style.display = "none";
    mobileInput.style.display = "block";
}

// AM PM toggle
amBtn.onclick = () => {
    amBtn.classList.add("active");
    pmBtn.classList.remove("active");
};

pmBtn.onclick = () => {
    pmBtn.classList.add("active");
    amBtn.classList.remove("active");
};

// ENTER key support
document.addEventListener("keydown", e => {
    if (!isTouch && e.key === "Enter") {
        calculate();
    }
});

// focus + auto jump (DESKTOP ONLY)
if (!isTouch) {
    window.onload = () => hh.focus();

    hh.addEventListener("input", () => {
        if (hh.value.length === 2) mm.focus();
    });

    mm.addEventListener("input", () => {
        if (mm.value.length === 2) ss.focus();
    });
}

function calculate() {
    const result = document.getElementById("result");

    let hours = 0;
    let minutes = 0;
    let seconds = 0;

    if (isTouch) {
        const val = mobileTime.value;
        if (!val) return;

        const parts = val.split(":");
        hours = parseInt(parts[0],10) || 0;
        minutes = parseInt(parts[1],10) || 0;
        seconds = parseInt(parts[2] || 0,10) || 0;

    } else {
        const hRaw = hh.value.replace(/\D/g,"");
        const mRaw = mm.value.replace(/\D/g,"");
        const sRaw = ss.value.replace(/\D/g,"");

        let h = parseInt(hRaw || 0,10);
        minutes = parseInt(mRaw || 0,10);
        seconds = parseInt(sRaw || 0,10);

        if (h >= 13) {
            hours = h;
        } else {
            if (h === 12) h = 0;
            hours = pmBtn.classList.contains("active") ? h + 12 : h;
        }
    }

    let totalSeconds =
        hours * 3600 +
        minutes * 60 +
        seconds +
        (8 * 3600) +
        (45 * 60);

    totalSeconds %= 86400;

    const outH24 = Math.floor(totalSeconds / 3600);
    const outM = Math.floor((totalSeconds % 3600) / 60);
    const outS = totalSeconds % 60;

    const outAMPM = outH24 >= 12 ? "PM" : "AM";
    const outH12 = outH24 % 12 || 12;

    result.style.display = "block";
    result.textContent =
        `You can leave at ${outH12}:${String(outM).padStart(2,"0")}:${String(outS).padStart(2,"0")} ${outAMPM}`;
}

function resetAll() {
    hh.value = "";
    mm.value = "";
    ss.value = "";
    amBtn.classList.add("active");
    pmBtn.classList.remove("active");
    result.style.display = "none";
    hh.focus();
}
</script>
</body>
</html>
